# S-AESå°ç»„ä½œä¸š
## ä¸€ ã€ä½œä¸šä»»åŠ¡

### ç¬¬ä¸€å…³ï¼šåŸºæœ¬æµ‹è¯•

**GUIç”¨æˆ·äº¤äº’ç•Œé¢é¦–é¡µ**ï¼šç”¨æˆ·é€‰æ‹©åŠ å¯†æˆ–è§£å¯†æ“ä½œã€‚

![[1-1]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/1-1.png)

**åŠ å¯†ç•Œé¢**ï¼šç”¨æˆ·è¾“å…¥éœ€è¦åŠ å¯†çš„æ˜æ–‡ï¼ˆéœ€è¦åœ¨äºŒè¿›åˆ¶æ¨¡å¼å’ŒASCIIæ¨¡å¼ä¸­è¿›è¡Œé€‰æ‹©ï¼‰ä»¥åŠç›¸å…³çš„å¯†é’¥ï¼Œå¾—åˆ°åŠ å¯†åçš„å¯†æ–‡

**äºŒè¿›åˆ¶ï¼ˆ16-bitï¼‰æ¨¡å¼**ï¼š
å¦‚å›¾ï¼Œå½“è¾“å…¥æ˜æ–‡ä¸º1111111111111111ï¼Œå¯†é’¥ä¸º0000000000000000æ—¶ï¼Œå¾—åˆ°åŠ å¯†åçš„å¯†æ–‡ä¸º0010100100110000ã€‚

![[1-2]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/1-2.png)

å¦‚æœè¾“å…¥çš„å†…å®¹ä¸è§„èŒƒï¼ˆéäºŒè¿›åˆ¶16bitæ˜æ–‡ï¼ŒéäºŒè¿›åˆ¶16bitå¯†é’¥ï¼‰ï¼Œä¼šè¿›è¡Œç›¸åº”çš„é”™è¯¯æç¤ºã€‚


![[1-3]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/1-3.png)


![[1-4]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/1-4.png)


**è§£å¯†ç•Œé¢**ï¼šç”¨æˆ·è¾“å…¥éœ€è¦è§£å¯†çš„å¯†æ–‡ï¼ˆåŒæ ·éœ€è¦åœ¨äºŒè¿›åˆ¶æ¨¡å¼å’ŒASCIIæ¨¡å¼ä¸­è¿›è¡Œé€‰æ‹©ï¼‰ä»¥åŠç›¸å…³çš„å¯†é’¥ï¼Œå¾—åˆ°è§£å¯†åçš„æ˜æ–‡ã€‚

**äºŒè¿›åˆ¶ï¼ˆ16-bitï¼‰æ¨¡å¼ï¼š**

å¦‚å›¾ï¼Œå½“è¾“å…¥å¯†æ–‡ä¸º0010100100110000ï¼Œå¯†é’¥ä¸º0000000000000000æ—¶ï¼Œå¾—åˆ°è§£å¯†åçš„æ˜æ–‡ä¸ä¸Šè¿°åŠ å¯†å‰çš„æ˜æ–‡ä¸€è‡´ï¼Œä¸º1111111111111111

![[1-5]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/1-5.png)

åŒæ ·ï¼Œå¦‚æœè¾“å…¥çš„å†…å®¹ä¸è§„èŒƒï¼ˆéäºŒè¿›åˆ¶16bitå¯†æ–‡ï¼ŒéäºŒè¿›åˆ¶16bitå¯†é’¥ï¼‰ï¼Œä¹Ÿä¼šè¿›è¡Œç›¸åº”çš„é”™è¯¯æç¤ºã€‚


![[1-6]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/1-6.png)



![[1-7]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/1-7.png)

### ç¬¬äºŒå…³ï¼šäº¤å‰æµ‹è¯•

å‚è€ƒå…¶ä»–å°ç»„ä¸­çš„æµ‹è¯•å†…å®¹ï¼Œå¯ä»¥éªŒè¯æˆ‘ä»¬çš„åŠ å¯†ä»¥åŠè§£å¯†è¿‡ç¨‹å¯ä»¥å¾—åˆ°ä¸å…¶ä»–å°ç»„åŒæ ·çš„ç»“æœã€‚
ï¼ˆå‚è€ƒå°ç»„çš„githubé“¾æ¥ï¼š[https://github.com/dori0512/S-AES-by-qt](https://github.com/dori0512/S-AES-by-qt)ï¼›[https://github.com/Mercurius14/S-AES-HW](https://github.com/Mercurius14/S-AES-HW)ï¼›[https://github.com/Xialanshan/S_AES](https://github.com/Xialanshan/S_AES)ï¼‰

**äºŒè¿›åˆ¶ï¼ˆ16-bitï¼‰æ¨¡å¼ä¸‹åŠ å¯†**ï¼š

æ˜æ–‡ï¼š1111111111111111

å¯†é’¥ï¼š1111111111111111

å¯†æ–‡ï¼š0101001101000011

![[2-1]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/2-1.png)


**äºŒè¿›åˆ¶ï¼ˆ16-bitï¼‰æ¨¡å¼ä¸‹è§£å¯†**ï¼š

å¯†æ–‡ï¼š0101001101000011

å¯†é’¥ï¼š1111111111111111

æ˜æ–‡ï¼š1111111111111111

![[2-2]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/2-2.png)


**ASCIIæ¨¡å¼ä¸‹åŠ å¯†**ï¼š

æ˜æ–‡ï¼šasdasx

å¯†é’¥ï¼š1111111111111111

å¯†æ–‡ï¼š4SÃŸ&P

![[2-3]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/2-3.png)


**ASCIIæ¨¡å¼ä¸‹è§£å¯†:**

å¯†æ–‡: 4SÃŸ&P

å¯†é’¥: 1111111111111111

æ˜æ–‡: asdasx

![[2-4]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/2-4.png)

**åŒé‡åŠ å¯†æ¨¡å¼ä¸‹åŠ å¯†:**

æ˜æ–‡ï¼š0000111100001111

å¯†é’¥ï¼š00101101010101011010011100111011

ç”Ÿæˆå¯†æ–‡ï¼š1110010001011110

![\[2-5\]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/2-5.png)

**åŒé‡åŠ å¯†æ¨¡å¼ä¸‹è§£å¯†:**

å¯†æ–‡ï¼š1110010001011110

å¯†é’¥ï¼š00101101010101011010011100111011

è§£å¯†ç»“æœï¼š0000111100001111

![\[2-6\]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/2-6.png)

**ä¸‰é‡åŠ å¯†æ¨¡å¼ä¸‹åŠ å¯†:**

æ˜æ–‡ï¼š0110111101101011

å¯†é’¥ï¼š00000000000000001010011100111011

ç”Ÿæˆå¯†æ–‡ï¼š0000111110110100


![\[2-7\]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/2-7.png)


**ä¸‰é‡åŠ å¯†æ¨¡å¼ä¸‹è§£å¯†:**

å¯†æ–‡ï¼š0000111110110100

å¯†é’¥ï¼š00000000000000001010011100111011

è§£å¯†ç»“æœï¼š0110111101101011

![\[2-8\]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/2-8.png)


### ç¬¬ä¸‰å…³ï¼šæ‰©å±•åŠŸèƒ½

æˆ‘ä»¬å¯¹è¯¥é¡¹ç›®è¿›è¡Œäº†æ‹“å±•ï¼Œå®ç°äº†ä»¥ASCIIç ä¸ºæ˜æ–‡è¾“å…¥å’Œå¯†æ–‡è¾“å‡ºçš„åŠŸèƒ½ã€‚ä¸‹é¢æ˜¯åŠ å¯†æ¼”ç¤ºï¼š

æ˜æ–‡ï¼šzxzxzxzx

å¯†é’¥ï¼š0000000000000000

 å¯†æ–‡ï¼šrÃ‚rÃ‚rÃ‚rÃ‚

![[3-1]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/3-1.png)

ä¸‹é¢æ˜¯ç›¸åº”çš„è§£å¯†æ¼”ç¤ºï¼š

![[3-2]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/3-2.png)

è§£å¯†æˆåŠŸï¼Œå¾—åˆ°ç›¸åº”çš„æ˜æ–‡ï¼Œç¬¬ä¸‰å…³é€šè¿‡ã€‚

### ç¬¬å››å…³ï¼šå¤šé‡åŠ å¯†

#### 4-1 åŒé‡åŠ å¯†

æˆ‘ä»¬å®ç°äº†å°†S-AESç®—æ³•é€šè¿‡åŒé‡åŠ å¯†è¿›è¡Œæ‰©å±•ï¼Œåˆ†ç»„é•¿åº¦ä»ç„¶ä¸º16bitsï¼Œå¯†é’¥é•¿åº¦æ‰©å±•åˆ°32bitsã€‚

ä¸‹é¢æ˜¯åŠ è§£å¯†æ¼”ç¤ºï¼š

å¯¹æ˜æ–‡è¿›è¡ŒåŠ å¯†ï¼š

æ˜æ–‡ï¼š1001010101110001

å¯†é’¥ï¼š11110000101010010001101010101001

ç”Ÿæˆå¯†æ–‡ï¼š1111000011001011


![[4-1-1]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/4-1-1.png)

å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†ï¼š

![[4-1-2]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/4-1-2.png)


è§£å¯†ç»“æœä¸æ˜æ–‡å®Œå…¨ä¸€è‡´ã€‚



#### 4-2 ä¸­é—´ç›¸é‡æ”»å‡»

åˆ©ç”¨ä½¿ç”¨ç›¸åŒå¯†é’¥çš„æ˜å¯†æ–‡å¯¹ï¼Œé‡‡ç”¨ä¸­é—´ç›¸é‡æ”»å‡»çš„æ–¹æ³•æ‰¾åˆ°æ­£ç¡®çš„å¯†é’¥Keyï¼ˆK1+K2ï¼‰ã€‚
åˆ©ç”¨å¯†é’¥'0010110101010101'+'1010011100111011'è·å–å¦‚ä¸‹æ˜å¯†æ–‡å¯¹ã€‚

|æ˜æ–‡|å¯†æ–‡|
|--|--|--|
|0000111100001111  | 1110010001011110 |
|1111111100000000 |0010010001010010|
|1100110011001101 |1010101100100010|

è¿›è¡Œä¸­é—´ç›¸é‡æ”»å‡»ï¼š

![\[4-2\]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/4-2.png)

æœ€ç»ˆå¾—åˆ°Key=K1+K2ï¼ˆ00101101010101011010011100111011ï¼‰ã€‚


#### 4-3 ä¸‰é‡åŠ å¯†

å°†S-AESç®—æ³•é€šè¿‡ä¸‰é‡åŠ å¯†è¿›è¡Œæ‰©å±•ï¼ŒæŒ‰ç…§32bitså¯†é’¥Key(K1+K2)çš„æ¨¡å¼è¿›è¡Œä¸‰é‡åŠ å¯†è§£å¯†ã€‚

ä¸‹é¢æ˜¯åŠ å¯†æ¼”ç¤ºï¼š

æ˜æ–‡ï¼š1010111100000001

å¯†é’¥ï¼š00000000000000001111111111111111

ç”Ÿæˆå¯†æ–‡ï¼š0110001100110010

![\[4-3-1\]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/4-3-1.png)

ä¸‹é¢è¿›è¡Œè§£å¯†æ¼”ç¤ºï¼š

![\[4-3-2\]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/4-3-2.png)

å¾—åˆ°çš„è§£å¯†ç»“æœå’Œæ˜æ–‡ä¸€è‡´ã€‚


### ç¬¬äº”å…³ï¼šå·¥ä½œæ¨¡å¼

åŸºäºS-AESç®—æ³•ï¼Œä½¿ç”¨å¯†ç åˆ†ç»„é“¾(CBC)æ¨¡å¼å¯¹è¾ƒé•¿çš„æ˜æ–‡æ¶ˆæ¯è¿›è¡ŒåŠ å¯†ã€‚

æ³¨æ„åˆå§‹å‘é‡(16 bits) çš„ç”Ÿæˆï¼Œå¹¶éœ€è¦åŠ è§£å¯†åŒæ–¹å…±äº«ã€‚

åœ¨CBCæ¨¡å¼ä¸‹è¿›è¡ŒåŠ å¯†ï¼Œå¯¹å¯†æ–‡åˆ†ç»„è¿›è¡Œæ›¿æ¢æˆ–ä¿®æ”¹ï¼Œç„¶åè¿›è¡Œè§£å¯†ï¼Œå¯¹æ¯”ç¯¡æ”¹å¯†æ–‡å‰åçš„è§£å¯†ç»“æœå¦‚ä¸‹ï¼š

æ˜æ–‡ï¼š111101

å¯†é’¥ï¼š11100100001011110

IVå‘é‡ï¼š0000111100001111

ç”Ÿæˆå¯†æ–‡ï¼šÂ‡Â†Â¹Ã˜Â«

![\[5-1\]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/5-1.png)


å¯†æ–‡æœªè¿›è¡Œç¯¡æ”¹çš„è§£å¯†ç»“æœå¦‚ä¸‹ï¼š

![\[5-2\]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/5-2.png)

å¯¹å¯†æ–‡è¿›è¡Œç¯¡æ”¹çš„è§£å¯†ç»“æœå¦‚ä¸‹ï¼š


![\[5-3\]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/5-3.png)


ä¸¤æ¬¡ç”Ÿæˆçš„æ˜æ–‡ä¸ä¸€è‡´ï¼Œè¯´æ˜å¯†æ–‡è¢«ç¯¡æ”¹åæ— æ³•å¾—åˆ°æ­£ç¡®çš„æ˜æ–‡ã€‚






## äºŒã€ç”¨æˆ·æ‰‹å†Œ
### 1ã€S-AESç®—æ³•ä»‹ç»

* S-AESï¼ˆSimplified Advanced Encryption Standardï¼‰ç®—æ³•æ˜¯ä¸€ç§è½»é‡çº§çš„å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œæ˜¯å¯¹é«˜çº§åŠ å¯†æ ‡å‡†ï¼ˆAESï¼‰çš„ç®€åŒ–ç‰ˆæœ¬ã€‚

* S-AESç®—æ³•åœ¨åŠ å¯†è¿‡ç¨‹ä¸­åº”ç”¨äº†ä¸€ç³»åˆ—çš„åŸºæœ¬è¿ç®—ï¼ŒåŒ…æ‹¬ä»£æ›¿ï¼ˆSubstitutionï¼‰ã€è¡Œä½ç§»ï¼ˆShift Rowï¼‰ã€åˆ—æ··æ·†ï¼ˆMix Columnsï¼‰å’Œå¯†é’¥åŠ ï¼ˆKey Additionï¼‰ç­‰æ­¥éª¤ã€‚è¿™äº›æ­¥éª¤ä½¿å¾—S-AESèƒ½å¤Ÿå¯¹è¾“å…¥çš„æ•°æ®è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œä»è€Œç”Ÿæˆå®‰å…¨çš„å¯†æ–‡ã€‚

### 2ã€ä½¿ç”¨æ­¥éª¤
#### ï¼ˆ1ï¼‰ å¯åŠ¨S-AESå¯†ç ç³»ç»Ÿä»¥è¿›å…¥ä¸»ç•Œé¢

![\[u-1\]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/u-1.png)

#### ï¼ˆ2ï¼‰ é€‰æ‹©åŠ å¯†ã€è§£å¯†æˆ–è€…CBCåŠ /è§£å¯†æ“ä½œ

åŠ å¯†ç•Œé¢ï¼š

![\[u-2\]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/u-2.png)


è§£å¯†ç•Œé¢ï¼š

![\[u-3\]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/u-3.png)

CBCåŠ /è§£å¯†ç•Œé¢ï¼š

![\[u-4\]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/u-4.png)


#### ï¼ˆ3ï¼‰é€‰æ‹©ä½¿ç”¨ï¼ˆäºŒè¿›åˆ¶ï¼ˆ16-bitï¼‰æ¨¡å¼/ASCIIæ¨¡å¼ï¼‰ã€ï¼ˆå•æ¬¡åŠ å¯†æ¨¡å¼/åŒé‡åŠ å¯†æ¨¡å¼/ä¸‰é‡åŠ å¯†æ¨¡å¼ï¼‰è¿›è¡ŒåŠ è§£å¯†ã€‚

![\[u-5\]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/u-5.png)

#### ï¼ˆ4ï¼‰è¾“å…¥éœ€è¦åŠ å¯†ï¼ˆè§£å¯†ï¼‰çš„æ˜æ–‡ï¼ˆå¯†æ–‡ï¼‰åŠå…¶å¯†é’¥ï¼ˆå¯†é’¥è¾“å…¥æ—¶é»˜è®¤éšè—ï¼Œå¦‚éœ€è¦æ˜¾ç¤ºå¯ç‚¹å‡»å³ä¾§çš„â€œæ˜¾ç¤ºå¯†é’¥â€ï¼‰ï¼Œå¦‚æœæ ¼å¼é”™è¯¯ä¼šæœ‰ç›¸åº”çš„æç¤º

![\[u-6\]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/u-6.png)


#### ï¼ˆ5ï¼‰å¾—åˆ°åŠ å¯†ï¼ˆè§£å¯†ï¼‰ä¹‹åçš„å¯†æ–‡ï¼ˆæ˜æ–‡ï¼‰ç»“æœ

![\[u-7\]](https://github.com/zzzxxxxzzz/S-AES/blob/main/image/u-7.png)



#  
##  ä¸‰ã€å¼€å‘è€…æ‰‹å†Œ

### 1ã€ç³»ç»Ÿç»“æ„ 
 S-AESï¼ˆSimplified Advanced Encryption Standardï¼‰ç®—æ³•æ˜¯ä¸€ç§è½»é‡çº§çš„å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œæ˜¯å¯¹é«˜çº§åŠ å¯†æ ‡å‡†ï¼ˆAESï¼‰çš„ç®€åŒ–ç‰ˆæœ¬ã€‚

 S-AESç®—æ³•åœ¨åŠ å¯†è¿‡ç¨‹ä¸­åº”ç”¨äº†ä¸€ç³»åˆ—çš„åŸºæœ¬è¿ç®—ï¼ŒåŒ…æ‹¬ä»£æ›¿ï¼ˆSubstitutionï¼‰ã€è¡Œä½ç§»ï¼ˆShift Rowï¼‰ã€åˆ—æ··æ·†ï¼ˆMix Columnsï¼‰å’Œå¯†é’¥åŠ ï¼ˆKey Additionï¼‰ç­‰æ­¥éª¤ã€‚

æ ¹æ®S-AESç®—æ³•çš„æ‰§è¡Œæ­¥éª¤ï¼Œæˆ‘ä»¬çš„S-ESç³»ç»Ÿç»“æ„å¦‚ä¸‹ï¼š

#### 1.GUIç”¨æˆ·ç•Œé¢ï¼ˆæä¾›ç”¨æˆ·è¿›è¡ŒåŠ è§£å¯†äº¤äº’æ“ä½œçš„ç•Œé¢ï¼‰

#### 2.åŸºç¡€åŠ å¯†ï¼ˆè§£å¯†ï¼‰æ“ä½œï¼š

ï¼ˆ1ï¼‰å¯†é’¥æ‰©å±•ï¼šæ ¹æ®ç”¨æˆ·æä¾›çš„16bitså¤§å°çš„å¯†é’¥ç”Ÿæˆä¸‰ç»„16bitsçš„å­å¯†é’¥

```java
public static String[] KeyExpansion(String key) {  

String w0 = key.substring(0, 8);  
String w1 = key.substring(8, 16);   
String w2 = Xor(w0, Xor(RECON1, SubNib(RotNib(w1))));  
String w3 = Xor(w2, w1);  
String w4 = Xor(w2, Xor(RECON2, SubNib(RotNib(w3))));  
String w5 = Xor(w4, w3);  
 
String[] res = { w0 + w1, w2 + w3, w4 + w5 };  
  
return res;  
}
```

ï¼ˆ2ï¼‰æ•°æ®åŠ å¯†ï¼šä¾ç…§S-AESç®—æ³•çš„åŠ å¯†åŸºæœ¬æµç¨‹è¿›è¡ŒåŠ å¯†æ“ä½œï¼š
è½®å¯†é’¥åŠ â†’ç¬¬ä¸€è½®åŠ å¯†ï¼ˆåŒ…å«å››ä¸ªå‡½æ•°çš„å®Œæ•´è½®ï¼šåŠå­—èŠ‚ä»£æ›¿â†’è¡Œä½ç§»â†’åˆ—æ··æ·†â†’è½®å¯†é’¥åŠ ï¼‰
â†’ç¬¬äºŒè½®åŠ å¯†ï¼ˆåŒ…å«ä¸‰ä¸ªå‡½æ•°ï¼šåŠå­—èŠ‚ä»£æ›¿â†’è¡Œä½ç§»â†’è½®å¯†é’¥åŠ ï¼‰â†’å®ŒæˆåŠ å¯†
```java
public static String encrypt(String plainText, String key) {  
//å¯†é’¥æ‰©å±•
String[] key_expansion = KeyExpansion(key);  
// å¯†é’¥åŠ   
String text_cipher = addRoundKey(plainText, key_expansion[0]);  
// è½®å‡½æ•°  
text_cipher = SubNib(text_cipher);  
text_cipher = ShiftRow(text_cipher);  
text_cipher = MixColumns(text_cipher);  
// å¯†é’¥åŠ   
text_cipher = addRoundKey(text_cipher, key_expansion[1]);  
// è½®å‡½æ•°  
text_cipher = SubNib(text_cipher);  
text_cipher = ShiftRow(text_cipher);  
// å¯†é’¥åŠ   
text_cipher = addRoundKey(text_cipher, key_expansion[2]);  
  
return text_cipher;  
}
```

ï¼ˆ3ï¼‰æ•°æ®è§£å¯†ï¼šä¾ç…§S-AESç®—æ³•çš„è§£å¯†åŸºæœ¬æµç¨‹è¿›è¡Œè§£å¯†æ“ä½œï¼š
è½®å¯†é’¥åŠ â†’ç¬¬ä¸€è½®è§£å¯†ï¼ˆåŒ…å«å››ä¸ªå‡½æ•°çš„å®Œæ•´è½®ï¼šé€†è¡Œä½ç§»â†’é€†åŠå­—èŠ‚ä»£æ›¿
â†’è½®å¯†é’¥åŠ â†’é€†åˆ—æ··æ·†ï¼‰â†’ç¬¬äºŒè½®åŠ å¯†ï¼ˆåŒ…å«ä¸‰ä¸ªå‡½æ•°ï¼šé€†è¡Œä½ç§»â†’é€†åŠå­—èŠ‚ä»£æ›¿â†’è½®å¯†é’¥åŠ ï¼‰
â†’å®Œæˆè§£å¯†

```java
// S-AESè§£å¯†å‡½æ•°  
public static String decrypt(String ciphperText, String key) {
//å¯†é’¥æ‰©å±•  
String[] key_expansion = KeyExpansion(key);  
//è½®å¯†é’¥åŠ 
String text_plain = addRoundKey(ciphperText, key_expansion[2]);  
//ç¬¬ä¸€è½®è§£å¯†
text_plain = ShiftRow(text_plain);  
text_plain = InvSubNib(text_plain);  
text_plain = addRoundKey(text_plain, key_expansion[1]);  
text_plain = InvMixColumns(text_plain);  
//ç¬¬äºŒè½®è§£å¯†
text_plain = ShiftRow(text_plain);  
text_plain = InvSubNib(text_plain);  
//è½®å¯†é’¥åŠ 
text_plain = addRoundKey(text_plain, key_expansion[0]);  
  
return text_plain;  
}
```


### 2ã€å…³é”®ä»£ç ç»„ä»¶
#### 1ã€SAESç±»ï¼ˆç”¨äºè¿›è¡ŒåŸºç¡€16bitsæ˜å¯†æ–‡åŠ è§£å¯†åŠŸèƒ½çš„ç±»ï¼‰

ï¼ˆ1ï¼‰ éœ€è¦ç”¨åˆ°çš„ç½®æ¢ç›’
``` java
// å®šä¹‰S-AESç®—æ³•æ‰€éœ€è¦çš„ç½®æ¢è¡¨
private static final int[][] SBOX = {  
{ 9, 4, 10, 11 },  
{ 13, 1, 8, 5 },  
{ 6, 2, 0, 3 },  
{ 12, 14, 15, 7 }  
};  

private static final int[][] ISBOX = {  
{ 10, 5, 9, 11 },  
{ 1, 7, 8, 15 },  
{ 6, 0, 2, 3 },  
{ 12, 4, 13, 14 }  
};
```
ï¼ˆ2ï¼‰å¯†é’¥æ‰©å±•å‡½æ•°
```java
public static String[] KeyExpansion(String key) {  

String w0 = key.substring(0, 8);  
String w1 = key.substring(8, 16);   
String w2 = Xor(w0, Xor(RECON1, SubNib(RotNib(w1))));  
String w3 = Xor(w2, w1);  
String w4 = Xor(w2, Xor(RECON2, SubNib(RotNib(w3))));  
String w5 = Xor(w4, w3);  
 
String[] res = { w0 + w1, w2 + w3, w4 + w5 };  
  
return res;  
}
```
ï¼ˆ3ï¼‰å¼‚æˆ–å‡½æ•°
```java
// ä¸¤å­—ç¬¦ä¸²çš„å¼‚æˆ–æ“ä½œ  
public static String Xor(String bit1, String bit2) {  
if (bit1.length() != bit2.length()) {  
throw new IllegalArgumentException("Input strings must have the same length.");  
}  
  
StringBuilder A = new StringBuilder();  
  
for (int i = 0; i < bit1.length(); i++) {  
char char1 = bit1.charAt(i);  
char char2 = bit2.charAt(i);  
if (char1 == char2) {  
A.append('0');  
} else {  
A.append('1');  
}  
}  
return A.toString();  
}
```
ï¼ˆ4ï¼‰è½®å¯†é’¥åŠ å‡½æ•°
```java
// å®ç°å¯†é’¥åŠ å‡½æ•°  
public static String addRoundKey(String bit1, String bit2) {  
if (bit1.length() != bit2.length()) {  
throw new IllegalArgumentException("Input strings must have the same length.");  
}  
StringBuilder A = new StringBuilder();  
  
for (int i = 0; i < bit1.length(); i++) {  
char char1 = bit1.charAt(i);  
char char2 = bit2.charAt(i);  
if (char1 == char2) {  
A.append('0');  
} else {  
A.append('1');  
}  
}  
// System.out.print("main:"+A.length());  
return A.toString();  
  
}
```

ï¼ˆ5ï¼‰åŠå­—èŠ‚æ›¿ä»£å‡½æ•°
```java
public static String SubNib(String bit1) {  
  
// System.out.print("zzzzz:"+bit1.length());  
StringBuilder res = new StringBuilder();  
for (int i = 0; i < bit1.length(); i += 4) {  
String patch = bit1.substring(i, i + 4);  
int row = Integer.parseInt(patch.substring(0, 2), 2);  
int col = Integer.parseInt(patch.substring(2, 4), 2);  
int substituteValue = SBOX[row][col];  
String substituteNibble = Integer.toBinaryString(substituteValue);  
  
while (substituteNibble.length() < 4) {  
substituteNibble = "0" + substituteNibble;  
}  
  
res.append(substituteNibble);  
}  
  
return res.toString();  
}
```
ï¼ˆ6ï¼‰é€†åŠå­—èŠ‚æ›¿ä»£å‡½æ•°
```java
// å®ç°é€†åŠå­—èŠ‚  
public static String InvSubNib(String bit1) {  
  
StringBuilder res = new StringBuilder();  
  
for (int i = 0; i < 16; i += 4) {  
String patch = bit1.substring(i, i + 4);  
int row = Integer.parseInt(patch.substring(0, 2), 2);  
int col = Integer.parseInt(patch.substring(2, 4), 2);  
int substituteValue = ISBOX[row][col];  
String substituteNibble = Integer.toBinaryString(substituteValue);  
  
while (substituteNibble.length() < 4) {  
substituteNibble = "0" + substituteNibble;  
}  
  
res.append(substituteNibble);  
}  
  
return res.toString();  
}

```
ï¼ˆ7ï¼‰è¡Œä½ç§»å‡½æ•°
```java
// å®ç°è¡Œä½ç§»  
public static String ShiftRow(String bit1) {  
  
String row1 = bit1.substring(0, 4);  
String row2 = bit1.substring(4, 8);  
String row3 = bit1.substring(8, 12);  
String row4 = bit1.substring(12, 16);  
  
// è¿›è¡Œè¡Œä½ç§»  
String res = row1 + row4 + row3 + row2;  
  
return res;  
}
```

ï¼ˆ8ï¼‰åˆ—æ··æ·†å‡½æ•°
```java
public static String MixColumns(String bits) {  
  
String col1 = bits.substring(0, 4);  
String col2 = bits.substring(4, 8);  
String col3 = bits.substring(8, 12);  
String col4 = bits.substring(12, 16);  
  
String res = Xor(col1, GF("0100", col2)) + Xor(GF("0100", col1), col2) +  
Xor(col3, GF("0100", col4)) + Xor(GF("0100", col3), col4);  
  
return res;  
}
```

ï¼ˆ9ï¼‰é€†åˆ—æ··æ·†å‡½æ•°
```java
// å®ç°é€†åˆ—æ··æ·†  
public static String InvMixColumns(String bits) {  
  
String col1 = bits.substring(0, 4);  
String col2 = bits.substring(4, 8);  
String col3 = bits.substring(8, 12);  
String col4 = bits.substring(12, 16);  
  
String res = Xor(GF("1001", col1), GF("0010", col2)) + Xor(GF("0010", col1), GF("1001", col2)) +  
Xor(GF("1001", col3), GF("0010", col4)) + Xor(GF("0010", col3), GF("1001", col4));  
return res;  
  
}
```

ï¼ˆ10ï¼‰CBCæ¨¡å¼åŠ å¯†å‡½æ•°ï¼š
```java
// CBCåŠ å¯†å‡½æ•°  
public static String CBC_encrypt(String plainText, String key, String IV) {  
// å°†ASCIIç è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²  
StringBuilder binaryText = new StringBuilder();  
for (char c : plainText.toCharArray()) {  
String binaryChar = Integer.toBinaryString(c);  
while (binaryChar.length() < 8) {  
binaryChar = "0" + binaryChar;  
}  
binaryText.append(binaryChar);  
}  
  
// é›¶å¡«å……ï¼Œç¡®ä¿æ–‡æœ¬é•¿åº¦æ˜¯16çš„å€æ•°  
int remainder = binaryText.length() % 16;  
if (remainder != 0) {  
int paddingLength = 16 - remainder;  
for (int i = 0; i < paddingLength; i++) {  
binaryText.append("0");  
}  
}  
  
// æ¯16ä½è¿›è¡Œåˆ‡å‰²ï¼Œå¹¶æ”¾å…¥å­—ç¬¦ä¸²æ•°ç»„  
int blockCount = binaryText.length() / 16;  
String[] binaryBlocks = new String[blockCount];  
String[] cipherBlocks = new String[blockCount];  
for (int i = 0; i < blockCount; i++) {  
binaryBlocks[i] = binaryText.substring(i * 16, (i + 1) * 16);  
}  
  
// åˆå§‹åŒ–ä¸€ä¸ªStringBuilderæ¥å­˜å‚¨åŠ å¯†åçš„äºŒè¿›åˆ¶å—  
StringBuilder encryptedText = new StringBuilder();  
  
String PXorIV = Xor(binaryBlocks[0], IV);  
String PXorC;  
cipherBlocks[0] = SAES.encrypt(PXorIV, key);  
encryptedText.append(cipherBlocks[0]);  
for (int i = 1; i < blockCount; i++) {  
PXorC = Xor(binaryBlocks[i], cipherBlocks[i - 1]);  
cipherBlocks[i] = SAES.encrypt(PXorC, key);  
encryptedText.append(cipherBlocks[i]);  
}  
  
// å°†åŠ å¯†åçš„äºŒè¿›åˆ¶å—è½¬æ¢ä¸ºASCIIç å½¢å¼  
StringBuilder asciiCipherText = new StringBuilder();  
for (int i = 0; i < encryptedText.length(); i += 8) {  
String binaryChar = encryptedText.substring(i, i + 8);  
int asciiValue = Integer.parseInt(binaryChar, 2);  
char asciiChar = (char) asciiValue;  
asciiCipherText.append(asciiChar);  
}  
  
return asciiCipherText.toString();  
}
```
ï¼ˆ11ï¼‰CBCæ¨¡å¼è§£å¯†å‡½æ•°ï¼š
```java
// CBCè§£å¯†å‡½æ•°  
public static String CBC_decrypt(String cipherText, String key, String IV) {  
// å°†ASCIIç è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²  
StringBuilder binaryText = new StringBuilder();  
for (char c : cipherText.toCharArray()) {  
String binaryChar = Integer.toBinaryString(c);  
while (binaryChar.length() < 8) {  
binaryChar = "0" + binaryChar;  
}  
binaryText.append(binaryChar);  
}  
  
// é›¶å¡«å……ï¼Œç¡®ä¿æ–‡æœ¬é•¿åº¦æ˜¯16çš„å€æ•°  
int remainder = binaryText.length() % 16;  
if (remainder != 0) {  
int paddingLength = 16 - remainder;  
for (int i = 0; i < paddingLength; i++) {  
binaryText.append("0");  
}  
}  
  
// æ¯16ä½è¿›è¡Œåˆ‡å‰²ï¼Œå¹¶æ”¾å…¥å­—ç¬¦ä¸²æ•°ç»„  
int blockCount = binaryText.length() / 16;  
System.out.println("blockæ•°ä¸ºï¼š"+blockCount);  
String[] binaryBlocks = new String[blockCount];  
String[] plainBlocks = new String[blockCount];  
for (int i = 0; i < blockCount; i++) {  
binaryBlocks[i] = binaryText.substring(i * 16, (i + 1) * 16);  
System.out.println("ç¬¬"+i+"ä¸ªbinaryBlockä¸ºï¼š"+binaryBlocks[i]);  
}  
  
// åˆå§‹åŒ–ä¸€ä¸ªStringBuilderæ¥å­˜å‚¨åŠ å¯†åçš„äºŒè¿›åˆ¶å—  
StringBuilder encryptedText = new StringBuilder();  
  
String D0 = SAES.decrypt(binaryBlocks[0], key);  
plainBlocks[0] = Xor(IV, D0);  
encryptedText.append(plainBlocks[0]);  
String D;  
for (int i = 1; i < blockCount; i++) {  
D = SAES.decrypt(binaryBlocks[i], key);  
plainBlocks[i] = Xor(binaryBlocks[i-1], D);  
encryptedText.append(plainBlocks[i]);  
}  
  
// å°†åŠ å¯†åçš„äºŒè¿›åˆ¶å—è½¬æ¢ä¸ºASCIIç å½¢å¼  
StringBuilder asciiCipherText = new StringBuilder();  
for (int i = 0; i < encryptedText.length(); i += 8) {  
String binaryChar = encryptedText.substring(i, i + 8);  
int asciiValue = Integer.parseInt(binaryChar, 2);  
char asciiChar = (char) asciiValue;  
asciiCipherText.append(asciiChar);  
}  
  
return asciiCipherText.toString();  
}
```

####  2ã€ç”¨æˆ·ç•Œé¢è®¾è®¡

ï¼ˆ1ï¼‰ä¸»ç•Œé¢
```java
public class UI extends JFrame{  
Encrypt_GUI encrypt_GUI;  
Decrypt_GUI decrypt_GUI;  
CBC_GUI cbc_GUI;  
JLabel welcomeLabel;  
JButton decryptButton,encryptButton,cbcButton;  
  
UI(){  
JFrame frame = new JFrame();  
frame.setTitle("S-AESåŠ å¯†ç³»ç»Ÿ");  
frame.setSize(800, 600);  
frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);  
frame.setLocationRelativeTo(null);  
frame.setResizable(false);  
frame.setLayout(null);  
  
//è®¾ç½®åŸºç¡€è¿›å…¥ç•Œé¢  
welcomeLabel = new JLabel("æ¬¢è¿ä½¿ç”¨S-AESåŠ å¯†ç³»ç»Ÿï¼");  
welcomeLabel.setFont(new Font("å®‹ä½“", Font.TYPE1_FONT, 30));  
welcomeLabel.setBounds(220, 120, 400, 130);  
encryptButton = new JButton("åŠ å¯†æ˜æ–‡");  
encryptButton.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
encryptButton.setBounds(180, 315, 130, 50);  
encryptButton.addActionListener(new ActionListener() {  
public void actionPerformed(ActionEvent e){  
frame.setVisible(false);  
encrypt_GUI = new Encrypt_GUI();  
}  
});  
  
decryptButton = new JButton("è§£å¯†å¯†æ–‡");  
decryptButton.setBounds(330, 315, 130, 50);  
decryptButton.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
decryptButton.addActionListener(new ActionListener() {  
public void actionPerformed(ActionEvent e){  
frame.setVisible(false);  
decrypt_GUI = new Decrypt_GUI();  
}  
});  
  
cbcButton = new JButton("CBCåŠ /è§£å¯†");  
cbcButton.setBounds(480, 315, 130, 50);  
cbcButton.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
cbcButton.addActionListener(new ActionListener() {  
public void actionPerformed(ActionEvent e){  
frame.setVisible(false);  
cbc_GUI = new CBC_GUI();  
}  
});  
  
frame.add(welcomeLabel);  
frame.add(encryptButton);  
frame.add(decryptButton);  
frame.add(cbcButton);  
frame.setVisible(true);  
  
}  
}
```

ï¼ˆ2ï¼‰åŠ å¯†ç•Œé¢
```java
import java.awt.Dimension;  
import java.awt.Font;  
import java.awt.event.ActionEvent;  
import java.awt.event.ActionListener;  
import java.awt.event.ItemEvent;  
import java.awt.event.ItemListener;  
import java.util.Random;  
import javax.swing.*;  
  
public class Encrypt_GUI {  
JTextField dataField;  
JTextArea resulTextArea;  
JPasswordField keyJPasswordField;  
JLabel dataJLabel, keyJLabel, resultJLabel, welcomeLabel;  
JCheckBox checkBox;  
JButton button1, button2;  
JOptionPane warning;  
String dataString, cipherText;  
  
String keyString;  
int[] key;  
Box box_H_01, box_H_02, box_H_03, box_V;  
  
Encrypt_GUI() {  
init();  
}  
  
void init() {  
JFrame frame = new JFrame("Encrypt_GUI");  
  
// åˆå§‹åŒ–UIå¸ƒç½®ç»„ä»¶  
box_H_01 = Box.createHorizontalBox();  
box_H_02 = Box.createHorizontalBox();  
box_H_03 = Box.createHorizontalBox();  
box_V = Box.createVerticalBox();  
  
// è®¾ç½®çª—ä½“å¯¹è±¡çš„å±æ€§å€¼  
frame.setTitle("åŠ å¯†ç•Œé¢");  
frame.setSize(900, 650);  
frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);  
frame.setLocationRelativeTo(null);  
frame.setResizable(false);  
frame.setLayout(null);  
  
// è®¾ç½®æ¬¢è¿æ ‡ç­¾  
welcomeLabel = new JLabel("æ¬¢è¿ä½¿ç”¨S-AESåŠ å¯†ç³»ç»Ÿï¼");  
welcomeLabel.setFont(new Font("å®‹ä½“", Font.TYPE1_FONT, 30));  
welcomeLabel.setBounds(265, 40, 400, 80);  
  
// æ˜æ–‡è¾“å…¥æ¨¡å¼é€‰æ‹©æŒ‰é’®  
JRadioButton textModeRadioButton = new JRadioButton("äºŒè¿›åˆ¶(16-bit)æ¨¡å¼");  
JRadioButton asciiModeRadioButton = new JRadioButton("ASCIIæ¨¡å¼");  
JRadioButton key1 = new JRadioButton("å•æ¬¡åŠ å¯†æ¨¡å¼");  
JRadioButton key2 = new JRadioButton("åŒé‡åŠ å¯†æ¨¡å¼");  
JRadioButton key3 = new JRadioButton("ä¸‰é‡åŠ å¯†æ¨¡å¼");  
ButtonGroup modeButtonGroup = new ButtonGroup();  
ButtonGroup keyButtonGroup = new ButtonGroup();  
modeButtonGroup.add(textModeRadioButton);  
modeButtonGroup.add(asciiModeRadioButton);  
textModeRadioButton.setSelected(true);  
textModeRadioButton.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
asciiModeRadioButton.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
textModeRadioButton.setBounds(250, 105, 210, 30);  
asciiModeRadioButton.setBounds(500, 105, 115, 30);  
  
keyButtonGroup.add(key1);  
keyButtonGroup.add(key2);  
keyButtonGroup.add(key3);  
key1.setSelected(true);  
key1.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
key2.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
key3.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
key1.setBounds(240, 135, 145, 30);  
key2.setBounds(385, 135, 145, 30);  
key3.setBounds(530, 135, 145, 30);  
  
// æ˜æ–‡è¾“å…¥  
dataJLabel = new JLabel("æ˜æ–‡ï¼š");  
dataJLabel.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
dataField = new JTextField();  
dataField.setPreferredSize(new Dimension(150, 25));  
dataField.setFont(new Font("å¾®è½¯é›…é»‘", Font.PLAIN, 18));  
  
// å¯†é’¥è¾“å…¥  
keyJLabel = new JLabel("å¯†é’¥ï¼š");  
keyJLabel.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
keyJPasswordField = new JPasswordField();  
keyJPasswordField.setEchoChar('*');  
keyJPasswordField.setPreferredSize(new Dimension(150, 25));  
keyJPasswordField.setFont(new Font("å¾®è½¯é›…é»‘", Font.PLAIN, 18));  
  
// å¯†é’¥å¯è§†æŒ‰é’®  
checkBox = new JCheckBox("æ˜¾ç¤ºå¯†é’¥");  
checkBox.setSize(new Dimension(70, 35));  
checkBox.setFont(new Font("é»‘ä½“", Font.TYPE1_FONT, 21));  
checkBox.addItemListener(new ItemListener() {  
public void itemStateChanged(ItemEvent e) {  
if (e.getStateChange() == ItemEvent.SELECTED) {  
keyJPasswordField.setEchoChar((char) 0);  
} else {  
keyJPasswordField.setEchoChar('*');  
}  
}  
});  
checkBox.setBounds(650, 255, 130, 70);  
  
// å¯†æ–‡æ˜¾ç¤º  
resultJLabel = new JLabel("å¯†æ–‡ï¼š");  
resultJLabel.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
resulTextArea = new JTextArea();  
resulTextArea.setPreferredSize(new Dimension(180, 80));  
resulTextArea.setFont(new Font("å¾®è½¯é›…é»‘", Font.PLAIN, 18));  
resulTextArea.setEditable(false);  
  
// åŠ å¯†æŒ‰é’®  
button1 = new JButton();  
button1.setText("åŠ å¯†");  
button1.setFont(new Font("é»‘ä½“", Font.PLAIN, 19));  
button1.setSize(new Dimension(100, 50));  
  
// åŠ å¯†æŒ‰é’®  
button1.addActionListener(new ActionListener() {  
public void actionPerformed(ActionEvent e) {  
if (textModeRadioButton.isSelected()) {  
// æ–‡æœ¬æ¨¡å¼  
String dataInput = dataField.getText().trim();  
String keyInput = new String(keyJPasswordField.getPassword());  
if (!isValidBinary(dataInput)) {  
warning.showMessageDialog(frame, "è¯·è¾“å…¥16ä½çš„äºŒè¿›åˆ¶æ˜æ–‡ï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
} else if (!isValidBinaryKey16(keyInput) && key1.isSelected()) {  
warning.showMessageDialog(frame, "è¯·è¾“å…¥16ä½çš„äºŒè¿›åˆ¶å¯†é’¥ï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
} else if (!isValidBinaryKey32(keyInput) && (key2.isSelected() || key3.isSelected())) {  
warning.showMessageDialog(frame, "è¯·è¾“å…¥32ä½çš„äºŒè¿›åˆ¶å¯†é’¥ï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
} else {  
if (key1.isSelected()) {  
// è·å–æ˜æ–‡  
dataString = dataInput;  
  
// è·å–å¯†é’¥  
keyString = keyInput;  
  
cipherText = SAES.encrypt(dataString, keyString);  
resulTextArea.setText(cipherText);  
} else if (key2.isSelected()) {  
// è·å–æ˜æ–‡  
dataString = dataInput;  
  
// è·å–å¯†é’¥  
keyString = keyInput;  
int splitIndex = keyString.length() / 2;  
String key1String = keyString.substring(0, splitIndex);  
String key2String = keyString.substring(splitIndex);  
// åŒé‡åŠ å¯†  
cipherText = SAES.encrypt(SAES.encrypt(dataString, key1String), key2String);  
resulTextArea.setText(cipherText);  
} else if (key3.isSelected()) {  
// è·å–æ˜æ–‡  
dataString = dataInput;  
  
// è·å–å¯†é’¥  
keyString = keyInput;  
int splitIndex = keyString.length() / 2;  
String key1String = keyString.substring(0, splitIndex);  
String key2String = keyString.substring(splitIndex);  
String cipherText1;  
String cipherText2;  
// ä¸‰é‡åŠ å¯†  
cipherText = SAES.encrypt(dataString, key1String);  
cipherText1 = SAES.decrypt(cipherText, key2String);  
cipherText2 = SAES.encrypt(cipherText1, key1String);  
resulTextArea.setText(cipherText2);  
}  
  
}  
} else if (asciiModeRadioButton.isSelected()) {  
// ASCIIæ¨¡å¼  
String keyInput = new String(keyJPasswordField.getPassword());  
if (dataField.getText().trim().equals("")) {  
warning.showMessageDialog(frame, "æ˜æ–‡ä¸èƒ½ä¸ºç©ºï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
} else if (!isValidBinaryKey16(keyInput) && key1.isSelected()) {  
warning.showMessageDialog(frame, "è¯·è¾“å…¥16ä½çš„äºŒè¿›åˆ¶å¯†é’¥ï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
} else if (!isValidBinaryKey32(keyInput) && (key2.isSelected() || key3.isSelected())) {  
warning.showMessageDialog(frame, "è¯·è¾“å…¥32ä½çš„äºŒè¿›åˆ¶å¯†é’¥ï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
} else {  
// è·å–æ˜æ–‡  
String asciiText = dataField.getText();  
// è·å–å¯†é’¥  
keyString = new String(keyJPasswordField.getPassword());  
// å°†ASCIIç è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²  
StringBuilder binaryText = new StringBuilder();  
for (char c : asciiText.toCharArray()) {  
String binaryChar = Integer.toBinaryString(c);  
while (binaryChar.length() < 8) {  
binaryChar = "0" + binaryChar;  
}  
binaryText.append(binaryChar);  
}  
  
// æ¯16ä½è¿›è¡Œåˆ‡å‰²ï¼Œå¹¶æ”¾å…¥å­—ç¬¦ä¸²æ•°ç»„  
int blockCount = binaryText.length() / 16;  
String[] binaryBlocks = new String[blockCount];  
for (int i = 0; i < blockCount; i++) {  
binaryBlocks[i] = binaryText.substring(i * 16, (i + 1) * 16);  
}  
// åˆå§‹åŒ–ä¸€ä¸ªStringBuilderæ¥å­˜å‚¨åŠ å¯†åçš„äºŒè¿›åˆ¶å—  
StringBuilder encryptedText = new StringBuilder();  
  
// å¯¹æ¯ä¸ª16ä½çš„äºŒè¿›åˆ¶å—è¿›è¡ŒSDESåŠ å¯†  
if (key1.isSelected()) {  
for (String block : binaryBlocks) {  
cipherText = SAES.encrypt(block, keyString); // å‡è®¾SAES.encryptæ¥å—16ä½çš„äºŒè¿›åˆ¶è¾“å…¥  
encryptedText.append(cipherText);  
}  
}  
else if (key2.isSelected()){  
int splitIndex = keyString.length() / 2;  
String key1String = keyString.substring(0, splitIndex);  
String key2String = keyString.substring(splitIndex);  
for (String block : binaryBlocks) {  
cipherText = SAES.encrypt(SAES.encrypt(block, key1String), key2String);  
encryptedText.append(cipherText);  
}  
}  
else if (key3.isSelected()){  
int splitIndex = keyString.length() / 2;  
String key1String = keyString.substring(0, splitIndex);  
String key2String = keyString.substring(splitIndex);  
for (String block : binaryBlocks) {  
cipherText = SAES.encrypt(SAES.decrypt(SAES.encrypt(block, key1String), key2String), key1String);  
encryptedText.append(cipherText);  
}  
}  
  
// å°†åŠ å¯†åçš„äºŒè¿›åˆ¶å—è½¬æ¢ä¸ºASCIIç å½¢å¼  
StringBuilder asciiCipherText = new StringBuilder();  
for (int i = 0; i < encryptedText.length(); i += 8) {  
String binaryChar = encryptedText.substring(i, i + 8);  
int asciiValue = Integer.parseInt(binaryChar, 2);  
char asciiChar = (char) asciiValue;  
asciiCipherText.append(asciiChar);  
}  
  
resulTextArea.setText(asciiCipherText.toString());  
}  
}  
}  
 //åˆ¤æ–­è¾“å…¥æ˜¯å¦ä¸ºäºŒè¿›åˆ¶
private boolean isValidBinary(String input) {  
  
return input.matches("[01]{16}");  
}  
  
private boolean isValidBinaryKey16(String input) {  
  
return input.matches("[01]{16}");  
}  
  
private boolean isValidBinaryKey32(String input) {  
  
return input.matches("[01]{32}");  
}  
});  
  
button1.setBounds(265, 500, 160, 40);  
  
// è¿”å›æŒ‰é’®  
button2 = new JButton("è¿”å›");  
button2.setFont(new Font("é»‘ä½“", Font.PLAIN, 19));  
button2.setSize(new Dimension(100, 50));  
button2.addActionListener(new ActionListener() {  
public void actionPerformed(ActionEvent e) {  
UI uI = new UI();  
frame.dispose();  
}  
});  
button2.setBounds(465, 500, 160, 40);  
  
// å¸ƒç½®å„ä¸ªç»„ä»¶  
box_H_01.add(dataJLabel);  
box_H_01.add(Box.createHorizontalStrut(5));  
box_H_01.add(dataField);  
  
box_H_02.add(keyJLabel);  
box_H_02.add(Box.createHorizontalStrut(5));  
box_H_02.add(keyJPasswordField);  
  
box_H_03.add(resultJLabel);  
box_H_03.add(Box.createHorizontalStrut(5));  
box_H_03.add(resulTextArea);  
  
box_V.add(box_H_01);  
box_V.add(Box.createVerticalStrut(40));  
box_V.add(box_H_02);  
box_V.add(Box.createVerticalStrut(30));  
box_V.add(box_H_03);  
box_V.setBounds(200, 170, 450, 300);  
  
frame.add(welcomeLabel);  
frame.add(box_V);  
frame.add(checkBox);  
frame.add(button1);  
frame.add(button2);  
frame.add(textModeRadioButton);  
frame.add(asciiModeRadioButton);  
frame.add(key1);  
frame.add(key2);  
frame.add(key3);  
frame.setVisible(true);  
}  
}
```


ï¼ˆ3ï¼‰è§£å¯†ç•Œé¢
```java
import javax.swing.*;  
import java.awt.event.ActionEvent;  
import java.awt.event.ActionListener;  
import java.awt.event.ItemEvent;  
import java.awt.event.ItemListener;  
import java.awt.Dimension;  
import java.awt.Font;  
  
public class Decrypt_GUI {  
JTextField dataField;  
JTextArea resulTextArea;  
JPasswordField keyJPasswordField;  
JLabel dataJLabel, keyJLabel, resultJLabel, welcomeLabel;  
JCheckBox checkBox;  
JButton button1, button2;  
JOptionPane warning;  
String dataString, plainText;  
String keyString;  
int[] key;  
Box box_H_01, box_H_02, box_H_03, box_V;  
SAES sDes;  
  
Decrypt_GUI() {  
init();  
}  
  
void init() {  
JFrame frame = new JFrame("Encrypt_GUI");  
  
// åˆå§‹åŒ–UIå¸ƒç½®ç»„ä»¶  
box_H_01 = Box.createHorizontalBox();  
box_H_02 = Box.createHorizontalBox();  
box_H_03 = Box.createHorizontalBox();  
box_V = Box.createVerticalBox();  
  
// è®¾ç½®çª—ä½“å¯¹è±¡çš„å±æ€§å€¼  
frame.setTitle("è§£å¯†ç•Œé¢");  
frame.setSize(900, 650);  
frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);  
frame.setLocationRelativeTo(null);  
frame.setResizable(false);  
frame.setLayout(null);  
  
// è®¾ç½®æ¬¢è¿æ ‡ç­¾  
welcomeLabel = new JLabel("æ¬¢è¿ä½¿ç”¨S-AESè§£å¯†ç³»ç»Ÿï¼");  
welcomeLabel.setFont(new Font("é»‘ä½“", Font.PLAIN, 30));  
welcomeLabel.setBounds(265, 40, 400, 80);  
  
// æ˜æ–‡è¾“å…¥æ¨¡å¼é€‰æ‹©æŒ‰é’®  
JRadioButton textModeRadioButton = new JRadioButton("äºŒè¿›åˆ¶(16-bit)æ¨¡å¼");  
JRadioButton asciiModeRadioButton = new JRadioButton("ASCIIæ¨¡å¼");  
JRadioButton key1 = new JRadioButton("å•æ¬¡åŠ å¯†æ¨¡å¼");  
JRadioButton key2 = new JRadioButton("åŒé‡åŠ å¯†æ¨¡å¼");  
JRadioButton key3 = new JRadioButton("ä¸‰é‡åŠ å¯†æ¨¡å¼");  
ButtonGroup modeButtonGroup = new ButtonGroup();  
ButtonGroup keyButtonGroup = new ButtonGroup();  
modeButtonGroup.add(textModeRadioButton);  
modeButtonGroup.add(asciiModeRadioButton);  
textModeRadioButton.setSelected(true);  
textModeRadioButton.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
asciiModeRadioButton.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
textModeRadioButton.setBounds(250, 105, 210, 30);  
asciiModeRadioButton.setBounds(500, 105, 120, 30);  
  
keyButtonGroup.add(key1);  
keyButtonGroup.add(key2);  
keyButtonGroup.add(key3);  
key1.setSelected(true);  
key1.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
key2.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
key3.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
key1.setBounds(240, 135, 145, 30);  
key2.setBounds(385, 135, 145, 30);  
key3.setBounds(530, 135, 145, 30);  
  
// å¯†æ–‡è¾“å…¥  
dataJLabel = new JLabel("å¯†æ–‡ï¼š");  
dataJLabel.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
dataField = new JTextField();  
dataField.setPreferredSize(new Dimension(150, 25));  
dataField.setFont(new Font("å¾®è½¯é›…é»‘", Font.PLAIN, 18));  
  
// å¯†é’¥è¾“å…¥  
keyJLabel = new JLabel("å¯†é’¥ï¼š");  
keyJLabel.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
keyJPasswordField = new JPasswordField();  
keyJPasswordField.setEchoChar('*');  
keyJPasswordField.setPreferredSize(new Dimension(150, 25));  
keyJPasswordField.setFont(new Font("å¾®è½¯é›…é»‘", Font.PLAIN, 18));  
  
// å¯†é’¥å¯è§†æŒ‰é’®  
checkBox = new JCheckBox("æ˜¾ç¤ºå¯†é’¥");  
checkBox.setSize(new Dimension(70, 35));  
checkBox.setFont(new Font("é»‘ä½“", Font.TYPE1_FONT, 21));  
checkBox.addItemListener(new ItemListener() {  
public void itemStateChanged(ItemEvent e) {  
if (e.getStateChange() == ItemEvent.SELECTED) {  
keyJPasswordField.setEchoChar((char) 0);  
} else {  
keyJPasswordField.setEchoChar('*');  
}  
}  
});  
checkBox.setBounds(650, 255, 130, 70);  
  
// æ˜æ–‡æ˜¾ç¤º  
resultJLabel = new JLabel("æ˜æ–‡ï¼š");  
resultJLabel.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
resulTextArea = new JTextArea();  
resulTextArea.setPreferredSize(new Dimension(180, 80));  
resulTextArea.setFont(new Font("å¾®è½¯é›…é»‘", Font.PLAIN, 18));  
resulTextArea.setEditable(false);  
  
// è§£å¯†æŒ‰é’®  
button1 = new JButton();  
button1.setText("è§£å¯†");  
button1.setFont(new Font("é»‘ä½“", Font.PLAIN, 19));  
button1.setSize(new Dimension(100, 50));  
button1.addActionListener(new ActionListener() {  
public void actionPerformed(ActionEvent e) {  
if (textModeRadioButton.isSelected()) {  
// æ–‡æœ¬æ¨¡å¼  
String dataInput = dataField.getText().trim();  
String keyInput = new String(keyJPasswordField.getPassword());  
if (!isValidBinary(dataInput)) {  
warning.showMessageDialog(frame, "è¯·è¾“å…¥16ä½çš„äºŒè¿›åˆ¶å¯†æ–‡ï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
} else if (!isValidBinaryKey16(keyInput) && key1.isSelected()) {  
warning.showMessageDialog(frame, "è¯·è¾“å…¥16ä½çš„äºŒè¿›åˆ¶å¯†é’¥ï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
} else if (!isValidBinaryKey32(keyInput) && (key2.isSelected() || key3.isSelected())) {  
warning.showMessageDialog(frame, "è¯·è¾“å…¥32ä½çš„äºŒè¿›åˆ¶å¯†é’¥ï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
} else {  
if (key1.isSelected()) {  
// è·å–å¯†æ–‡  
dataString = dataField.getText();  
// è·å–å¯†é’¥  
keyString = new String(keyJPasswordField.getPassword());  
  
plainText = SAES.decrypt(dataString, keyString);  
resulTextArea.setText(plainText);  
} else if (key2.isSelected()) {  
// è·å–å¯†æ–‡  
dataString = dataField.getText();  
// è·å–å¯†é’¥  
keyString = new String(keyJPasswordField.getPassword());  
int splitIndex = keyString.length() / 2;  
String key1String = keyString.substring(0, splitIndex);  
String key2String = keyString.substring(splitIndex);  
// åŒé‡è§£å¯†  
plainText = SAES.decrypt(SAES.decrypt(dataString, key2String), key1String);  
resulTextArea.setText(plainText);  
} else if (key3.isSelected()) {  
// è·å–å¯†æ–‡  
dataString = dataField.getText();  
// è·å–å¯†é’¥  
keyString = new String(keyJPasswordField.getPassword());  
int splitIndex = keyString.length() / 2;  
String key1String = keyString.substring(0, splitIndex);  
String key2String = keyString.substring(splitIndex);  
String plainText1;  
String plainText2;  
// ä¸‰é‡è§£å¯†  
plainText = SAES.decrypt(dataString, key1String);  
plainText1 = SAES.encrypt(plainText, key2String);  
plainText2 = SAES.decrypt(plainText1, key1String);  
resulTextArea.setText(plainText2);  
}  
}  
} else if (asciiModeRadioButton.isSelected()) {  
// ASCIIæ¨¡å¼  
String keyInput = new String(keyJPasswordField.getPassword());  
if (dataField.getText().trim().equals("")) {  
warning.showMessageDialog(frame, "å¯†æ–‡ä¸èƒ½ä¸ºç©ºï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
} else if (!isValidBinaryKey16(keyInput) && key1.isSelected()) {  
warning.showMessageDialog(frame, "è¯·è¾“å…¥16ä½çš„äºŒè¿›åˆ¶å¯†é’¥ï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
} else if (!isValidBinaryKey32(keyInput) && (key2.isSelected() || key3.isSelected())) {  
warning.showMessageDialog(frame, "è¯·è¾“å…¥32ä½çš„äºŒè¿›åˆ¶å¯†é’¥ï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
} else {  
// è·å–å¯†æ–‡  
String cipherText = dataField.getText();  
// è·å–å¯†é’¥  
keyString = new String(keyJPasswordField.getPassword());  
  
// å°†å¯†æ–‡è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²  
StringBuilder binaryText = new StringBuilder();  
for (char c : cipherText.toCharArray()) {  
String binaryChar = Integer.toBinaryString(c);  
while (binaryChar.length() < 8) {  
binaryChar = "0" + binaryChar;  
}  
binaryText.append(binaryChar);  
}  
  
// æ¯8ä½è¿›è¡Œåˆ‡å‰²ï¼Œå¹¶æ”¾å…¥å­—ç¬¦ä¸²æ•°ç»„  
int blockCount = binaryText.length() / 16;  
String[] binaryBlocks = new String[blockCount];  
for (int i = 0; i < blockCount; i++) {  
binaryBlocks[i] = binaryText.substring(i * 16, (i + 1) * 16);  
}  
  
// åˆå§‹åŒ–ä¸€ä¸ªStringBuilderæ¥å­˜å‚¨è§£å¯†åçš„äºŒè¿›åˆ¶å—  
StringBuilder decryptedText = new StringBuilder();  
  
// å¯¹æ¯ä¸ª8ä½çš„äºŒè¿›åˆ¶å—è¿›è¡ŒSDESè§£å¯†  
if (key1.isSelected()) {  
for (String block : binaryBlocks) {  
String plaintextBlock = SAES.decrypt(block, keyString); // ä½¿ç”¨SDESè§£å¯†  
decryptedText.append(plaintextBlock);  
}  
}  
else if(key2.isSelected()){  
int splitIndex = keyString.length() / 2;  
String key1String = keyString.substring(0, splitIndex);  
String key2String = keyString.substring(splitIndex);  
for (String block : binaryBlocks) {  
String plaintextBlock = SAES.decrypt(SAES.decrypt(block, key2String), key1String); // ä½¿ç”¨SDESè§£å¯†  
decryptedText.append(plaintextBlock);  
}  
}  
else if(key3.isSelected()){  
int splitIndex = keyString.length() / 2;  
String key1String = keyString.substring(0, splitIndex);  
String key2String = keyString.substring(splitIndex);  
for (String block : binaryBlocks) {  
String plaintextBlock = SAES.decrypt(SAES.encrypt(SAES.decrypt(block, key1String), key2String), key1String); // ä½¿ç”¨SDESè§£å¯†  
decryptedText.append(plaintextBlock);  
}  
}  
// å°†è§£å¯†åçš„äºŒè¿›åˆ¶å—è½¬æ¢ä¸ºASCIIç å½¢å¼  
StringBuilder asciiPlaintext = new StringBuilder();  
for (int i = 0; i < decryptedText.length(); i += 8) {  
String binaryChar = decryptedText.substring(i, i + 8);  
int asciiValue = Integer.parseInt(binaryChar, 2);  
char asciiChar = (char) asciiValue;  
asciiPlaintext.append(asciiChar);  
}  
  
resulTextArea.setText(asciiPlaintext.toString());  
  
}  
}  
}  
  
// å®šä¹‰ä¸€ä¸ªè¾…åŠ©æ–¹æ³•æ¥éªŒè¯äºŒè¿›åˆ¶è¾“å…¥æ˜¯å¦æœ‰æ•ˆ  
private boolean isValidBinary(String input) {  
// ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼éªŒè¯æ˜¯å¦æ˜¯16ä½äºŒè¿›åˆ¶è¾“å…¥  
return input.matches("[01]{16}");  
};  
  
// å®šä¹‰ä¸€ä¸ªè¾…åŠ©æ–¹æ³•æ¥éªŒè¯äºŒè¿›åˆ¶å¯†é’¥æ˜¯å¦æœ‰æ•ˆ  
private boolean isValidBinaryKey16(String input) {  
// ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼éªŒè¯æ˜¯å¦æ˜¯16ä½äºŒè¿›åˆ¶è¾“å…¥  
return input.matches("[01]{16}");  
}  
  
private boolean isValidBinaryKey32(String input) {  
  
return input.matches("[01]{32}");  
}  
});  
button1.setBounds(265, 500, 160, 40);  
  
// è¿”å›æŒ‰é’®  
button2 = new JButton("è¿”å›");  
button2.setFont(new Font("é»‘ä½“", Font.PLAIN, 19));  
button2.setSize(new Dimension(100, 50));  
button2.addActionListener(new ActionListener() {  
public void actionPerformed(ActionEvent e) {  
UI uI = new UI();  
frame.dispose();  
}  
});  
button2.setBounds(465, 500, 160, 40);  
  
// å¸ƒç½®å„ä¸ªç»„ä»¶  
box_H_01.add(dataJLabel);  
box_H_01.add(Box.createHorizontalStrut(5));  
box_H_01.add(dataField);  
  
box_H_02.add(keyJLabel);  
box_H_02.add(Box.createHorizontalStrut(5));  
box_H_02.add(keyJPasswordField);  
  
box_H_03.add(resultJLabel);  
box_H_03.add(Box.createHorizontalStrut(5));  
box_H_03.add(resulTextArea);  
  
box_V.add(box_H_01);  
box_V.add(Box.createVerticalStrut(40));  
box_V.add(box_H_02);  
box_V.add(Box.createVerticalStrut(30));  
box_V.add(box_H_03);  
box_V.setBounds(200, 170, 450, 300);  
  
frame.add(welcomeLabel);  
frame.add(box_V);  
frame.add(checkBox);  
frame.add(button1);  
frame.add(button2);  
frame.add(textModeRadioButton);  
frame.add(asciiModeRadioButton);  
frame.add(key1);  
frame.add(key2);  
frame.add(key3);  
frame.setVisible(true);  
}  
}
```
#### 3ã€ CBCæ¨¡å¼åŠ è§£å¯†ç•Œé¢
```java
import java.awt.Dimension;  
import java.awt.Font;  
import java.awt.event.ActionEvent;  
import java.awt.event.ActionListener;  
import java.awt.event.ItemEvent;  
import java.awt.event.ItemListener;  
import java.util.Random;  
  
import javax.swing.*;  
  
public class CBC_GUI {  
JTextField dataField, IVField;  
JTextArea resulTextArea;  
JPasswordField keyJPasswordField;  
JLabel dataJLabel, keyJLabel, resultJLabel, welcomeLabel, IVLabel;  
JCheckBox checkBox;  
JButton button1, button2;  
JOptionPane warning;  
JRadioButton encryptButton;  
JRadioButton decryptButton;  
String dataString, cipherText, IVString, resultString;  
  
String keyString;  
int[] key;  
Box box_H_01, box_H_02, box_H_03, box_H_04, box_V;  
  
CBC_GUI() {  
init();  
}  
  
void init() {  
JFrame frame = new JFrame("Encrypt_GUI");  
  
// åˆå§‹åŒ–UIå¸ƒç½®ç»„ä»¶  
box_H_01 = Box.createHorizontalBox();  
box_H_02 = Box.createHorizontalBox();  
box_H_03 = Box.createHorizontalBox();  
box_H_04 = Box.createHorizontalBox();  
box_V = Box.createVerticalBox();  
  
// è®¾ç½®çª—ä½“å¯¹è±¡çš„å±æ€§å€¼  
frame.setTitle("CBCåŠ /è§£å¯†ç•Œé¢");  
frame.setSize(900, 650);  
frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);  
frame.setLocationRelativeTo(null);  
frame.setResizable(false);  
frame.setLayout(null);  
  
// è®¾ç½®æ¬¢è¿æ ‡ç­¾  
welcomeLabel = new JLabel("æ¬¢è¿ä½¿ç”¨S-AESåŠ å¯†ç³»ç»Ÿï¼");  
welcomeLabel.setFont(new Font("å®‹ä½“", Font.TYPE1_FONT, 30));  
welcomeLabel.setBounds(265, 40, 400, 80);  
  
// åŠ /è§£å¯†æ¨¡å¼é€‰æ‹©  
encryptButton = new JRadioButton("åŠ å¯†æ¨¡å¼");  
decryptButton = new JRadioButton("è§£å¯†æ¨¡å¼");  
ButtonGroup modeButtonGroup = new ButtonGroup();  
modeButtonGroup.add(encryptButton);  
modeButtonGroup.add(decryptButton);  
encryptButton.setSelected(true);  
encryptButton.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
decryptButton.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
encryptButton.setBounds(250, 105, 180, 30);  
decryptButton.setBounds(500, 105, 115, 30);  
  
// ä¿¡æ¯è¾“å…¥  
dataJLabel = new JLabel("æ˜å¯†æ–‡:");  
dataJLabel.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
dataField = new JTextField();  
dataField.setPreferredSize(new Dimension(150, 25));  
dataField.setFont(new Font("å¾®è½¯é›…é»‘", Font.PLAIN, 18));  
  
// å¯†é’¥è¾“å…¥  
keyJLabel = new JLabel("å¯† é’¥ï¼š");  
keyJLabel.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
keyJPasswordField = new JPasswordField();  
keyJPasswordField.setEchoChar('*');  
keyJPasswordField.setPreferredSize(new Dimension(150, 25));  
keyJPasswordField.setFont(new Font("å¾®è½¯é›…é»‘", Font.PLAIN, 18));  
  
// IVè¾“å…¥  
IVLabel = new JLabel("IVå‘é‡:");  
IVLabel.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
IVField = new JTextField();  
IVField.setPreferredSize(new Dimension(150, 25));  
IVField.setFont(new Font("å¾®è½¯é›…é»‘", Font.PLAIN, 18));  
  
// å¯†é’¥å¯è§†æŒ‰é’®  
checkBox = new JCheckBox("æ˜¾ç¤ºå¯†é’¥");  
checkBox.setSize(new Dimension(70, 35));  
checkBox.setFont(new Font("é»‘ä½“", Font.TYPE1_FONT, 21));  
checkBox.addItemListener(new ItemListener() {  
public void itemStateChanged(ItemEvent e) {  
if (e.getStateChange() == ItemEvent.SELECTED) {  
keyJPasswordField.setEchoChar((char) 0);  
} else {  
keyJPasswordField.setEchoChar('*');  
}  
}  
});  
checkBox.setBounds(650, 225, 130, 70);  
  
// ç»“æœæ˜¾ç¤º  
resultJLabel = new JLabel("ç»“æœï¼š");  
resultJLabel.setFont(new Font("é»‘ä½“", Font.PLAIN, 18));  
resulTextArea = new JTextArea();  
resulTextArea.setPreferredSize(new Dimension(180, 80));  
resulTextArea.setFont(new Font("å¾®è½¯é›…é»‘", Font.PLAIN, 18));  
resulTextArea.setEditable(false);  
  
// åŠ /è§£å¯†æŒ‰é’®  
button1 = new JButton();  
button1.setText("åŠ /è§£å¯†");  
button1.setFont(new Font("é»‘ä½“", Font.PLAIN, 19));  
button1.setSize(new Dimension(100, 50));  
  
// åŠ /è§£å¯†æŒ‰é’®äº‹ä»¶  
button1.addActionListener(new ActionListener() {  
public void actionPerformed(ActionEvent e) {  
if (encryptButton.isSelected()) {  
// è·å–æ˜æ–‡  
String dataInput = dataField.getText().trim();  
String keyInput = new String(keyJPasswordField.getPassword());  
IVString = IVField.getText().trim();  
if (dataField.getText().trim().equals("")) {  
warning.showMessageDialog(frame, "æ˜æ–‡ä¸èƒ½ä¸ºç©ºï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
} else if (!isValidBinaryKey16(keyInput)) {  
warning.showMessageDialog(frame, "è¯·è¾“å…¥16ä½çš„äºŒè¿›åˆ¶å¯†é’¥ï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
} else if (!isValidBinaryKey16(IVString)) {  
warning.showMessageDialog(frame, "è¯·è¾“å…¥16ä½çš„äºŒè¿›åˆ¶IVå‘é‡ï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
} else {  
// è·å–å¯†é’¥  
keyString = new String(keyJPasswordField.getPassword());  
resultString = SAES.CBC_encrypt(dataInput, keyString, IVString);  
resulTextArea.setText(resultString);  
}  
} else if (decryptButton.isSelected()) {  
// è·å–å¯†æ–‡  
String dataInput = dataField.getText().trim();  
String keyInput = new String(keyJPasswordField.getPassword());  
IVString = IVField.getText().trim();  
if (dataField.getText().trim().equals("")) {  
warning.showMessageDialog(frame, "æ˜æ–‡ä¸èƒ½ä¸ºç©ºï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
} else if (!isValidBinaryKey16(keyInput)) {  
warning.showMessageDialog(frame, "è¯·è¾“å…¥16ä½çš„äºŒè¿›åˆ¶å¯†é’¥ï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
} else if (!isValidBinaryKey16(IVString)) {  
warning.showMessageDialog(frame, "è¯·è¾“å…¥16ä½çš„äºŒè¿›åˆ¶IVå‘é‡ï¼", "è­¦å‘Š", JOptionPane.WARNING_MESSAGE);  
}else {  
// è·å–å¯†é’¥  
keyString = new String(keyJPasswordField.getPassword());  
IVString = IVField.getText();  
resultString = SAES.CBC_decrypt(dataInput, keyString, IVString);  
resulTextArea.setText(resultString);  
}  
}  
}  
  
private boolean isValidBinaryKey16(String input) {  
  
return input.matches("[01]{16}");  
}  
});  
  
button1.setBounds(265, 500, 160, 40);  
  
// è¿”å›æŒ‰é’®  
button2 = new JButton("è¿”å›");  
button2.setFont(new Font("é»‘ä½“", Font.PLAIN, 19));  
button2.setSize(new Dimension(100, 50));  
button2.addActionListener(new ActionListener() {  
public void actionPerformed(ActionEvent e) {  
UI uI = new UI();  
frame.dispose();  
}  
});  
button2.setBounds(465, 500, 160, 40);  
  
// å¸ƒç½®å„ä¸ªç»„ä»¶  
box_H_01.add(dataJLabel);  
box_H_01.add(Box.createHorizontalStrut(5));  
box_H_01.add(dataField);  
  
box_H_02.add(keyJLabel);  
box_H_02.add(Box.createHorizontalStrut(5));  
box_H_02.add(keyJPasswordField);  
  
box_H_04.add(IVLabel);  
box_H_04.add(Box.createHorizontalStrut(5));  
box_H_04.add(IVField);  
  
box_H_03.add(resultJLabel);  
box_H_03.add(Box.createHorizontalStrut(5));  
box_H_03.add(resulTextArea);  
  
box_V.add(box_H_01);  
box_V.add(Box.createVerticalStrut(25));  
box_V.add(box_H_02);  
box_V.add(Box.createVerticalStrut(30));  
box_V.add(box_H_04);  
box_V.add(Box.createVerticalStrut(30));  
box_V.add(box_H_03);  
box_V.setBounds(200, 170, 450, 300);  
  
frame.add(welcomeLabel);  
frame.add(box_V);  
frame.add(checkBox);  
frame.add(button1);  
frame.add(button2);  
frame.add(encryptButton);  
frame.add(decryptButton);  
frame.setVisible(true);  
}  
}

```
#### 4ã€ ä¸­é—´ç›¸é‡æ”»å‡»
```java
(crack.java)

import java.util.ArrayList;  
import java.util.Scanner;  
  
public class crack {  
public static void main(String[] args) {  
System.out.println("å·²çŸ¥æ˜å¯†æ–‡å¯¹çš„æ•°é‡");  
Scanner scan = new Scanner(System.in);  
int number = scan.nextInt();// è®°å½•æ˜å¯†æ–‡å¯¹æ•°é‡  
String[] plainTextArr = new String[number];// è®°å½•æ˜æ–‡  
String[] cipherTextArr = new String[number];// è®°å½•å¯†æ–‡  
ArrayList<ArrayList<String>> keyArrays = new ArrayList<>(); // è®°å½•å¯èƒ½çš„å¯†é’¥  
  
int inputcount = 0;  
while (inputcount < number) {  
System.out.print("è¯·è¾“å…¥ç¬¬" + (inputcount + 1) + "æ¡æ˜æ–‡");  
plainTextArr[inputcount] = scan.next();  
System.out.print("è¯·è¾“å…¥ç¬¬" + (inputcount + 1) + "æ¡å¯†æ–‡");  
cipherTextArr[inputcount] = scan.next();  
inputcount++;  
}  
  
// è·å–å½“å‰æ—¶é—´çš„æ¯«ç§’æ•°ï¼Œä½œä¸ºèµ·å§‹æ—¶é—´  
long startTime = System.currentTimeMillis();  
int num = (int) Math.pow(2, 16); // 16bitçš„å¯†é’¥æœ‰2^16ç§å¯èƒ½  
for (int i = 0; i < number; i++) {  
int keynum = 0;// è®°å½•å¯†é’¥æ•°é‡  
String[] midText = new String[num]; // å¯èƒ½çš„Mid-text  
ArrayList<String> keyArray = new ArrayList<>();  
for (int j = 0; j < num; j++) {  
String binary = Integer.toBinaryString(j);  
int length = binary.length();  
// è¡¥ä½è‡³16bit  
while (length < 16) {  
binary = "0" + binary;  
length++;  
}  
midText[j] = SAES.encrypt(plainTextArr[i], binary); // å¾—åˆ°æ‰€æœ‰å¯èƒ½çš„Mid-textç»“æœ  
  
}  
  
for (int j = 0; j < num; j++) {  
String binary = Integer.toBinaryString(j);  
int length = binary.length();  
// è¡¥ä½è‡³16bit  
while (length < 16) {  
binary = "0" + binary;  
length++;  
}  
String test = SAES.decrypt(cipherTextArr[i], binary);  
  
for (int k = 0; k < num; k++) {  
if (test.equals(midText[k])) { // ç ´è§£å‡ºä¸€ä¸ªå¯†é’¥  
String binary_k = Integer.toBinaryString(k);  
int length_k = binary_k.length();  
// è¡¥ä½è‡³16bit  
while (length_k < 16) {  
binary_k = "0" + binary_k;  
length_k++;  
}  
keyArray.add(binary_k + binary);  
}  
}  
}  
keyArrays.add(keyArray);  
}  
  
// è·å–å½“å‰æ—¶é—´çš„æ¯«ç§’æ•°ï¼Œä½œä¸ºç»“æŸæ—¶é—´  
long endTime = System.currentTimeMillis();  
// è®¡ç®—ä»£ç å—çš„è¿è¡Œæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰  
long executionTime = endTime - startTime;  
// æŸ¥æ‰¾é‡å¤çš„å¯†é’¥  
ArrayList<String> sameKeyArray = new ArrayList<>();  
  
// éå†æ¯ä¸€ä¸ªArrayList  
// å¦‚æœkeyArraysä¸ä¸ºç©ºä¸”åŒ…å«è‡³å°‘ä¸€ä¸ªArrayList  
if (!keyArrays.isEmpty() && keyArrays.get(0) != null && !keyArrays.get(0).isEmpty()) {  
// é€‰æ‹©ç¬¬ä¸€ä¸ªArrayListä½œä¸ºå‚è€ƒ  
ArrayList<String> referenceList = keyArrays.get(0);  
  
// éå†å‚è€ƒArrayListçš„æ¯ä¸ªå­—ç¬¦ä¸²  
for (String str : referenceList) {  
boolean existsInAllLists = true;  
  
// éå†å…¶ä½™çš„ArrayList  
for (int i = 1; i < keyArrays.size(); i++) {  
ArrayList<String> currentList = keyArrays.get(i);  
if (!currentList.contains(str)) {  
existsInAllLists = false;  
break; // å¦‚æœä¸åœ¨æŸä¸€ä¸ªArrayListä¸­ï¼Œè·³å‡ºå†…å¾ªç¯  
}  
}  
  
// å¦‚æœå­—ç¬¦ä¸²å­˜åœ¨äºæ‰€æœ‰ArrayListä¸­ï¼Œæ·»åŠ åˆ°sameKeyArray  
if (existsInAllLists) {  
sameKeyArray.add(str);  
}  
}  
}  
  
System.out.println("å¯èƒ½çš„å¯†é’¥å¦‚ä¸‹ï¼š");  
if (sameKeyArray.size() == 0) {  
System.out.println("æ²¡æœ‰æ‰¾åˆ°å…±åŒçš„å¯†é’¥");  
} else {  
for (String key : sameKeyArray) {  
System.out.println("å¯†é’¥ï¼š" + key);  
}  
}  
System.out.println("èµ·å§‹æ—¶é—´ä¸ºï¼š");  
System.out.println(startTime);  
System.out.println("ç»ˆæ­¢æ—¶é—´ä¸ºï¼š");  
System.out.println(endTime);  
System.out.println("è¿è¡Œæ—¶é—´ä¸ºï¼š");  
System.out.println(executionTime + " æ¯«ç§’");  
  
scan.close();  
}  
}
```

